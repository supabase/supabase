import Layout from '~/layouts/DefaultGuideLayout'

export const meta = {
  id: 'quotas',
  title: 'Realtime Quotas',
  description: 'Understanding Realtime quotas',
  sidebar_label: 'Quotas',
}

## Quotas by Plan Tier

<Admonition type="note">
  Upgrade your plan to increase your quotas. Without a spend cap, or on an Enterprise plan, some quotas are still in place to protect budgets. All quotas are configurable per project. [Contact support](https://app.supabase.com/support/new) if you need your quotas increased. Our cluster supports millions of concurrent connections and message throughput for production workloads.
</Admonition>

|                          | Free | Pro |  Pro (no spend cap)  |  Team  | Enterprise |
|--------------------------|------|-----|----------------------|--------|------------|
| Concurrent clients       | 200  | 500 | 10,000               | 10,000 | 10,000     |
| Messages per second      | 100  | 500 | 2,500                | 2,500  | 2,500      |
| Channel joins per second | 100  | 500 | 2,500                | 2,500  | 2,500      |
| Channels per client      | 100  | 100 | 100                  | 100    | 100        |

You can customize your quotas by [contacting support](https://app.supabase.com/support/new).

## Client-Side Limiting

Some basic WebSocket message rate limiting is implemented client-side.

For example, the [multiplayer.dev demo](/docs/guides/realtime/quickstart#cursor-positions) instantiates the Supabase client with an `eventsPerSecond` parameter.

## Quota Errors

When you reach a quota errors can appear in backend logs and messages in the WebSocket connection.

<Admonition type="note">
  Use the [Realtime Inspector](https://realtime.supabase.com/inspector/new) to reproduce an error and share those connection details with Supabase support.
</Admonition>

### Backend Logs

If your project is being limited by a quota, check your [Realtime logs](https://app.supabase.com/project/_/database/realtime-logs).

### WebSocket Errors

- `tenant_events`: Clients will be disconnected if your project is generating too many messages per second. `supabase-js` should reconnect automatically when the message throughput decreases below your plan quota.

<Admonition type="note">
  An `event` is a WebSocket message delivered to, or sent from a client.
</Admonition>

Some quotas can cause a Channel join to be refused. Realtime will reply with one of the following WebSocket messages:

- `too_many_channels`: Too many channels currently joined for a single client.
- `too_many_connections`: Too many total concurrent connections for a project.
- `too_many_joins`: Too many Channel joins per second.

<Admonition type="note">
  Use your browser's developer tools to find the WebSocket initiation request and view individual messages.
</Admonition>

## Postgres Changes Payload Quota

Realtime Postgres Changes has a change payload size quota of 1 mebibyte (MiB).

When this quota is reached, the `new` and `old` record payloads only include the fields with a value size of less than or equal to 64 bytes.

## Presence Quotas

Realtime Presence is a CRDT backed in-memory key value store based on Phoenix Presence. It's more expensive to update a Presence than Broadcast a message.

The following quotas apply to Presence messages:

- 10 keys per object
- Message per second quota is 10% of your total Realtime message per second quota

export const Page = ({ children }) => <Layout meta={meta} children={children} />

export default Page
