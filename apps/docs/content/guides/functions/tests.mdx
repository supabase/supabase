---
id: 'tests'
title: 'Testing your Edge Functions with Deno 2'
description: 'How to test your Edge Functions with Deno 2 libraries'
subtitle: 'How to test your Edge Functions with Deno 2 libraries'
---

Testing is an essential step in the development process to ensure the correctness and performance of your Edge Functions.

Deno 2 offers testing, linting, and type checking capabilities out of the box. Here’s how to use them.

## Setting Up Deno 2 for Your Supabase Edge Functions

### Installing Deno 2

First, ensure you have Deno 2 installed on your system:

```bash
# For macOS and Linux users
curl -fsSL https://deno.land/install.sh | sh

# For Windows users (using PowerShell)
irm https://deno.land/install.ps1 | iex
```

Verify your installation:

```bash
deno --version
```

You should see a version number starting with 2.x.

### Integrating Deno 2 with Supabase Edge Functions

Within your Supabase project, set up a proper structure for testing:

```
└── supabase
    ├── functions
    │   ├── function-one
    │   │   └── index.ts
    │   ├── function-two
    │   │   └── index.ts
    │   └── tests
    │       ├── function-one.test.ts  # Tests for function-one
    │       └── function-two.test.ts  # Tests for function-two
    └── config.toml
```

## Creating Tests for Edge Functions

Here's an example test file for a simple edge function:

```tsx
// functions/tests/function-one.test.ts
import { assertEquals } from 'std/assert/mod.ts'
import { createClient } from '@supabase/supabase-js'

// Load environment variables - you'll need to create this file
// or use Deno.env integration for your specific environment
import '../.env.ts'

const supabaseUrl = Deno.env.get('SUPABASE_URL') ?? ''
const supabaseKey = Deno.env.get('SUPABASE_ANON_KEY') ?? ''

Deno.test('Function One - Basic functionality', async () => {
  if (!supabaseUrl) throw new Error('SUPABASE_URL is required.')
  if (!supabaseKey) throw new Error('SUPABASE_ANON_KEY is required.')

  const client = createClient(supabaseUrl, supabaseKey, {
    auth: {
      autoRefreshToken: false,
      persistSession: false,
      detectSessionInUrl: false,
    },
  })

  const { data, error } = await client.functions.invoke('function-one', {
    body: { param: 'test-value' },
  })

  if (error) {
    throw new Error(`Function invocation failed: ${error.message}`)
  }

  // Assert the expected response
  assertEquals(data.success, true)
  assertEquals(data.message, 'Operation completed successfully')
})
```

## Environment Variables for Testing

For local testing, you'll need to set up environment variables. You can create a script to set these variables in your terminal:

```bash
# setup-test-env.sh
export SUPABASE_URL="http://localhost:54321"
export SUPABASE_ANON_KEY="[your-key]"
```

Source this script before running tests:

```bash
source setup-test-env.sh
```

Alternatively, you can pass the environment variables directly when running tests:

```bash
SUPABASE_URL="http://localhost:54321" SUPABASE_ANON_KEY="your-key" deno test --allow-net --allow-env --allow-read ./functions/tests/
```

## Running the Tests

Execute your tests using the Deno task system:

```bash
# Run all tests
deno test --allow-net --allow-env --allow-read ./functions/tests/

# Run a specific test file
deno test --allow-net --allow-env --allow-read ./functions/tests/function-one.test.ts

# Run tests with watch mode for development
deno test --allow-net --allow-env --allow-read --watch ./functions/tests/
```

## Linting and Type Checking

Deno 2 provides built-in linting and type checking:

```bash
# Run the linter
deno lint ./functions/

# Run type checking
deno check ./functions/**/*.ts
```

## Running Edge Functions Locally

If you want to run your tests locally to validate their functionality, do the following:

1. **Configure your local edge runtime** to use deno 2. This requires CLI version v2.20.5 and above.

   ```toml
   [edge_runtime]
   enabled = true
   deno_version = 2
   ```

2. **Run your functions** in your local environment:

   ```bash
   # Start Supabase services
   supabase start

   # Serve your functions locally
   supabase functions serve
   ```
