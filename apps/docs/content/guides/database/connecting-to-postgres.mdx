---
id: 'connecting-to-postgres'
title: 'Connecting to your database'
description: 'Explore the options for connecting to your Postgres database.'
subtitle: 'Explore the options for connecting to your Postgres database.'
---

Supabase provides several options for programmatically connecting to your Postgres database:

1. Programmatic access using the Data APIs
1. Connection pooling for scalable connections
1. Direct connections using the built-in Postgres connection system
1. Using one of the many [Client Libraries](https://supabase.com/docs#client-libraries)

<Admonition type="caution">

Direct database connections will start resolving to an IPv6 address. Starting from January 26, 2024, projects will be gradually migrated to this behavior. If you connect to your database using the REST or GraphQL endpoints, this doesn't affect you. If you use the database connection string, see the GitHub discussion on [how to prepare for IPv6](https://github.com/orgs/supabase/discussions/17817).

</Admonition>

## Data APIs

Supabase provides auto-updating Data APIs. These are the easiest way to get started if you are managing data (fetching, inserting, updating). We provide several types of API to suit your preferences:

- [REST](/docs/guides/api): interact with your database through a REST interface.
- [GraphQL](/docs/guides/graphql/api): interact with your database through a GraphQL interface.
- [Realtime](/docs/guides/realtime#realtime-api): listen to database changes over websockets.

## Connection pooler

A "connection pool" is a system (external to Postgres) which manages Postgres connections.

When a client makes a request, the pooler "allocates" an available connection to the client. When the client transaction or session is completed the connection is returned to the pool and is free to be used by another client.

<Image
  alt="New migration files trigger migrations on the preview instance."
  src={{
    dark: '/docs/img/guides/database/connecting-to-postgres/how-connection-pooling-works.png',
    light:
      '/docs/img/guides/database/connecting-to-postgres/how-connection-pooling-works--light.png',
  }}
  caption="Connecting to the database directly vs using a Connection Pooler"
  zoomable
/>

Every Supabase project comes with a connection pooler for managing connections to your database. The pooler provides 2 important services:

1. It manages connections for applications that connect and disconnect from the database frequently. For example, serverless functions and ORMs such as Prisma, Drizzle, and Kysely often make and drop connections to the database. If they connected directly each time, they would quickly exhaust your database server's memory. To connect to your database efficiently with such tools, you need a pooler.
2. It provides an IPv4 endpoint to connect to your database, which you can use if your network provider doesn't support IPv6. This is unlike the direct database connection, which resolves to an IPv6 address, unless you've enabled the [IPv4 add-on](https://supabase.com/docs/guides/platform/ipv4-address).

<Admonition type="tip">

The connection pooler is available in 2 modes: `Transaction` and `Session`.

</Admonition>

Transaction mode is recommended if you are connecting from serverless environments. A connection is assigned to the client for the duration of a transaction. Two consecutive transactions from the same client can be executed over two different connections. Some session-based Postgres features such as prepared statements are _not available_ with this option.

Session mode is similar to connecting to your database directly. There is full support for prepared statements in this mode. When a new client connects, a connection is assigned to the client until it disconnects. You might run into pooler connection limits since the connection is held till the client disconnects.

You can find the connection pool config in the [Database settings](/dashboard/project/_/settings/database) inside the dashboard:

1. Go to the `Settings` section.
2. Click `Database`.
3. Under `Connection string`, make sure `Use connection pooling` is checked. Copy the URI.

### Pre-requisites

The connection pooler on Supabase projects currently uses the `pgbouncer` Postgres role to make an initial connection to the `postgres` database. If these permissions are revoked, you will not be able to use the pooler until the requisite permissions have been granted.

## Direct connections

You can also use a direct connection to connect directly to your Postgres database. By default, you can connect to it via IPv6, which isn't supported by all networks. If you need an IPv4 address, use the [connection pooler](#connection-pooler) instead or enable the [IPv4 add-on](https://supabase.com/docs/guides/platform/ipv4-address).

You can find the direct connection string in the [Database settings](https://supabase.com/dashboard/project/_/settings/database) inside the dashboard:

1. Go to the `Settings` section.
2. Click `Database`.
3. Under `Connection string`, make sure `Use connection pooling` is unchecked. Copy the URI.

## Choosing a connection method

- Are you performing operations supported by the Data APIs? We recommend using the APIs.
- Are you connecting to your database and then _disconnecting_ immediately (for example, are you running your code in a serverless environment)? Use the connection pooler in transaction mode.
- Are you on a network that doesn't support IPv6? Use the connection pooler. (If you need a long-lived connection, for example for prepared statements, use session mode.)
- Are you connecting to your database and _maintaining_ a connection, and does your network support IPv6? Use a direct connection.

## Connecting with SSL

You should connect to your database using SSL wherever possible, to prevent snooping and man-in-the-middle attacks.

You can obtain your connection info and Server root certificate from your application's dashboard:

![Connection Info and Certificate.](/docs/img/database/database-settings-ssl.png)

## Troubleshooting Supavisor

Connection pooler logs are found [here](https://supabase.com/dashboard/project/_/logs/pooler-logs). The following are common errors and their solutions:

- Max client connections reached
  This error happens when the number of connections to Supavisor is more than [the allowed limit of your compute add-on](https://supabase.com/docs/guides/platform/compute-add-ons). Upgrade the database to a higher compute add-on to increase the number of Supavisor connections.

- Connection failed \{:error, :eaddrnotavail} to 'db.xxx.supabase.co':5432
  Supavisor cannot connect to the customer database. This is usually caused if the target database is unable to respond.

- Connection failed \{:error, :nxdomain} to 'db.xxx.supabase.co':5432
  Supavisor cannot connect to the customer database. This is usually caused if the target database is unable to respond.

- Connection closed when state was authentication
  This error happens when either the database doesn’t exist or if the user doesn't have the right credentials.

- Subscribe error: \{:error, :worker_not_found}
  This log event is emitted when the client tries to connect to the database, but Supavisor does not have the necessary information to route the connection. Try reconnecting to the database as it can take some time for the project information to propagate to Supavisor.

- Subscribe error: \{:error, \{:badrpc, \{:error, \{:erpc, :timeout}}}}
  This is a timeout error when the communication between different Supavisor nodes takes longer than expected. Try reconnecting to the database.

- Terminating with reason :client_termination when state was :busy
  This error happens when the client terminates the connection before the connection with the database is completed.

## Finding your database hostname

Your database’s hostname is crucial for establishing a direct connection. It resolves to the underlying IP address of your database. To find your hostname, navigate to your [Database Settings](/dashboard/project/_/settings/database).

Note that the pooler (connection pooler) has a different IP than your database. To reveal the database host and direct connection string, hide the pooler connection string.

Example hostname: `db.<PROJECT_REF>.supabase.co`

## Managing your IP address

To determine your current IP address, you can use an IP address [lookup website](https://whatismyipaddress.com/hostname-ip) or the terminal command:

```shell
nslookup db.<PROJECT_REF>.supabase.co
```

This command queries the domain name servers to find the IP address of the given hostname.

Example IPv6 Address: `2a05:d014:1c06:5f0c:d7a9:8616:bee2:30df`

### IPv6 address

Upon project creation, a static IPv6 address is assigned. This address might change when:

- A project is paused or resumed.
- The database is upgraded.

### IPv4 address

Opting for the static [IPv4 add-on](https://supabase.com/docs/guides/platform/ipv4-address) provides a more stable connection address. The IPv4 address remains constant unless the project is paused or resumed.

Unlike the IPv6 address, upgrading your database doesn't affect the IPv4 address.
