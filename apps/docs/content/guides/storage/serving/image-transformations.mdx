---
id: 'storage-image-transformations'
title: 'Storage Image Transformations'
description: 'Transform images with Storage'
subtitle: 'Transform images with Storage'
sidebar_label: 'Image Transformations'
tocVideo: 'dLqSmxX3r7I'
---

Supabase Storage offers the functionality to optimize and resize images on the fly. Any image stored in your buckets can be transformed and optimized for fast delivery.

<Admonition type="note">

Image Resizing is currently enabled for [Pro Plan and above](/pricing).

</Admonition>

## Get a public URL for a transformed image

Our client libraries methods like `getPublicUrl` and `createSignedUrl` support the `transform` option. This returns the URL that serves the transformed image.

<Tabs
  scrollable
  size="small"
  type="underlined"
  defaultActiveId="js"
  queryGroup="language"
>
<TabPanel id="js" label="JavaScript">

```ts
import { createClient } from '@supabase/supabase-js'
const supabase = createClient('your_project_url', 'your_supabase_api_key')

// ---cut---
supabase.storage.from('bucket').getPublicUrl('image.jpg', {
  transform: {
    width: 500,
    height: 600,
  },
})
```

</TabPanel>
<$Show if="sdk:dart">
<TabPanel id="dart" label="Dart">

```dart
final url = supabase.storage.from('bucket').getPublicUrl(
      'image.jpg',
      transform: const TransformOptions(
        width: 500,
        height: 600,
      ),
    );
```

</TabPanel>
</$Show>
<$Show if="sdk:swift">
<TabPanel id="swift" label="Swift">

```swift
let url = try await supabase.storage.from("bucket")
  .getPublicURL(
    path: "image.jpg"
    options: TransformOptions(with: 500, height: 600)
  )
```

</TabPanel>
</$Show>
<$Show if="sdk:kotlin">
<TabPanel id="kotlin" label="Kotlin">

```kotlin
val url = supabase.storage.from("bucket").publicRenderUrl("image.jpg") {
    size(width = 500, height = 600)
}
```

</TabPanel>
</$Show>
<$Show if="sdk:python">
<TabPanel id="python" label="Python">

```python
url = supabase.storage.from_('avatars').get_public_url(
  'image.jpg',
  {
    'transform': {
      'width': 500,
      'height': 500,
    },
  }
)
```

</TabPanel>
</$Show>
</Tabs>

An example URL could look like this:

```
https://project_id.supabase.co/storage/v1/render/image/public/bucket/image.jpg?width=500&height=600`
```

## Signing URLs with transformation options

To share a transformed image in a private bucket for a fixed amount of time, provide the transform option when you create the signed URL:

<Tabs
  scrollable
  size="small"
  type="underlined"
  defaultActiveId="js"
  queryGroup="language"
>
<TabPanel id="js" label="JavaScript">

```ts
import { createClient } from '@supabase/supabase-js'
const supabase = createClient('your_project_url', 'your_supabase_api_key')

// ---cut---
supabase.storage.from('bucket').createSignedUrl('image.jpg', 60000, {
  transform: {
    width: 200,
    height: 200,
  },
})
```

</TabPanel>
<$Show if="sdk:dart">
<TabPanel id="dart" label="Dart">

```dart
final url = await supabase.storage.from('bucket').createSignedUrl(
      'image.jpg',
      60000,
      transform: const TransformOptions(
        width: 200,
        height: 200,
      ),
    );
```

</TabPanel>
</$Show>
<$Show if="sdk:swift">
<TabPanel id="swift" label="Swift">

```swift
let url = try await supabase.storage.from("bucket")
  .createSignedURL(
    path: "image.jpg",
    expiresIn: 60,
    transform: TransformOptions(
      width: 200,
      height: 200
    )
  )
```

</TabPanel>
</$Show>
<$Show if="sdk:kotlin">
<TabPanel id="kotlin" label="Kotlin">

```kotlin
val url = supabase.storage.from("bucket").createSignedUrl("image.jpg", 60.seconds) {
	size(200, 200)
}
```

</TabPanel>
</$Show>
</Tabs>

The transformation options are embedded into the token attached to the URL — they cannot be changed once signed.

## Downloading images

To download a transformed image, pass the `transform` option to the `download` function.

<Tabs
  scrollable
  size="small"
  type="underlined"
  defaultActiveId="js"
  queryGroup="language"
>
<TabPanel id="js" label="JavaScript">

```ts
import { createClient } from '@supabase/supabase-js'
const supabase = createClient('your_project_url', 'your_supabase_api_key')

// ---cut---
supabase.storage.from('bucket').download('image.jpg', {
  transform: {
    width: 800,
    height: 300,
  },
})
```

</TabPanel>
<$Show if="sdk:dart">
<TabPanel id="dart" label="Dart">

```dart
final data = await supabase.storage.from('bucket').download(
      'image.jpg',
      transform: const TransformOptions(
        width: 800,
        height: 300,
      ),
    );
```

</TabPanel>
</$Show>
<$Show if="sdk:swift">
<TabPanel id="swift" label="Swift">

```swift
let data = try await supabase.storage.from("bucket")
  .download(
    path: "image.jpg",
    options: TransformOptions(
      width: 800,
      height: 300
    )
  )
```

</TabPanel>
</$Show>
<$Show if="sdk:kotlin">
<TabPanel id="kotlin" label="Kotlin">

```kotlin
val data = supabase.storage.from("bucket").downloadAuthenticated("image.jpg") {
    transform {
        size(800, 300)
    }
}

//Or on JVM stream directly to a file
val file = File("image.jpg")
supabase.storage.from("bucket").downloadAuthenticatedTo("image.jpg", file) {
    transform {
        size(800, 300)
    }
}
```

</TabPanel>
</$Show>
<$Show if="sdk:python">
<TabPanel id="python" label="Python">

```python
response = supabase.storage.from_('bucket').download(
  'image.jpg',
  {
    'width': 800,
    'height': 300,
  },
)
```

</TabPanel>
</$Show>
</Tabs>

## Automatic image optimization (WebP)

When using the image transformation API, Storage will automatically find the best format supported by the client and return that to the client, without any code change. For instance, if you use Chrome when viewing a JPEG image and using transformation options, you'll see that images are automatically optimized as `webp` images.

As a result, this will lower the egress that you send to your users and your application will load much faster.

<Admonition type="note">

We currently only support WebP. AVIF support will come in the near future.

</Admonition>

**Disabling automatic optimization:**

In case you'd like to return the original format of the image and **opt-out** from the automatic image optimization detection, you can pass the `format=origin` parameter when requesting a transformed image, this is also supported in the JavaScript SDK starting from v2.2.0

<Tabs
  scrollable
  size="small"
  type="underlined"
  defaultActiveId="js"
  queryGroup="language"
>
<TabPanel id="js" label="JavaScript">

```ts
import { createClient } from '@supabase/supabase-js'
const supabase = createClient('your_project_url', 'your_supabase_api_key')

// ---cut---
await supabase.storage.from('bucket').download('image.jpeg', {
  transform: {
    width: 200,
    height: 200,
    format: 'origin',
  },
})
```

</TabPanel>
<$Show if="sdk:dart">
<TabPanel id="dart" label="Dart">

```dart
final data = await supabase.storage.from('bucket').download(
      'image.jpeg',
      transform: const TransformOptions(
        width: 200,
        height: 200,
        format: RequestImageFormat.origin,
      ),
    );
```

</TabPanel>
</$Show>
<$Show if="sdk:swift">
<TabPanel id="swift" label="Swift">

```swift
let data = try await supabase.storage.from("bucket")
  .download(
    path: "image.jpg",
    options: TransformOptions(
      width: 200,
      height: 200,
      format: "origin"
    )
  )
```

</TabPanel>
</$Show>
<$Show if="sdk:kotlin">
<TabPanel id="kotlin" label="Kotlin">

```kotlin
val data = supabase.storage.from("bucket").downloadAuthenticated("image.jpg") {
    transform {
        size(200, 200)
        format = ImageTransformation.Format.ORIGIN
    }
}

//Or on JVM stream directly to a file
val file = File("image.jpg")
supabase.storage.from("bucket").downloadAuthenticatedTo("image.jpg", file) {
    transform {
        size(200, 200)
        format = ImageTransformation.Format.ORIGIN
    }
}
```

</TabPanel>
</$Show>
<$Show if="sdk:python">
<TabPanel id="python" label="Python">

```python
response = supabase.storage.from_('bucket').download(
  'image.jpeg',
  {
    'transform': {
      'width': 200,
      'height': 200,
      'format': 'origin',
    },
  }
)
```

</TabPanel>
</$Show>
</Tabs>

## Next.js loader

You can use Supabase Image Transformation to optimize your Next.js images using a custom [Loader](https://nextjs.org/docs/api-reference/next/image#loader-configuration).

To get started, create a `supabase-image-loader.js` file in your Next.js project which exports a default function:

```ts
const projectId = '' // your supabase project id

export default function supabaseLoader({ src, width, quality }) {
  return `https://${projectId}.supabase.co/storage/v1/render/image/public/${src}?width=${width}&quality=${quality || 75}`
}
```

In your `next.config.js` file add the following configuration to instruct Next.js to use our custom loader

```js
module.exports = {
  images: {
    loader: 'custom',
    loaderFile: './supabase-image-loader.js',
  },
}
```

At this point you are ready to use the `Image` component provided by Next.js

```tsx
import Image from 'next/image'

const MyImage = (props) => {
  return <Image src="bucket/image.png" alt="Picture of the author" width={500} height={500} />
}
```

## Transformation options

We currently support a few transformation options focusing on optimizing, resizing, and cropping images.

### Optimizing

You can set the quality of the returned image by passing a value from 20 to 100 (with 100 being the highest quality) to the `quality` parameter. This parameter defaults to 80.

Example:

<Tabs
  scrollable
  size="small"
  type="underlined"
  defaultActiveId="js"
  queryGroup="language"
>
<TabPanel id="js" label="JavaScript">

```ts
import { createClient } from '@supabase/supabase-js'
const supabase = createClient('your_project_url', 'your_supabase_api_key')

// ---cut---
supabase.storage.from('bucket').download('image.jpg', {
  transform: {
    quality: 50,
  },
})
```

</TabPanel>
<$Show if="sdk:dart">
<TabPanel id="dart" label="Dart">

```dart
final data = await supabase.storage.from('bucket').download(
      'image.jpg',
      transform: const TransformOptions(
        quality: 50,
      ),
    );
```

</TabPanel>
</$Show>
<$Show if="sdk:swift">
<TabPanel id="swift" label="Swift">

```swift
let data = try await supabase.storage.from("bucket")
  .download(
    path: "image.jpg",
    options: TransformOptions(
      quality: 50
    )
  )
```

</TabPanel>
</$Show>
<$Show if="sdk:kotlin">
<TabPanel id="kotlin" label="Kotlin">

```kotlin
val data = supabase.storage["bucket"].downloadAuthenticated("image.jpg") {
    transform {
        quality = 50
    }
}

//Or on JVM stream directly to a file
val file = File("image.jpg")
supabase.storage["bucket"].downloadAuthenticatedTo("image.jpg", file) {
    transform {
        quality = 50
    }
}
```

</TabPanel>
</$Show>
<$Show if="sdk:python">
<TabPanel id="python" label="Python">

```python
response = supabase.storage.from_('bucket').download(
  'image.jpg',
  {
    'transform': {
      'quality': 50,
    },
  }
)
```

</TabPanel>
</$Show>
</Tabs>

### Resizing

You can use `width` and `height` parameters to resize an image to a specific dimension. If only one parameter is specified, the image will be resized and cropped, maintaining the aspect ratio.

### Modes

You can use different resizing modes to fit your needs, each of them uses a different approach to resize the image:

Use the `resize` parameter with one of the following values:

- `cover` : resizes the image while keeping the aspect ratio to fill a given size and crops projecting parts. (default)

- `contain` : resizes the image while keeping the aspect ratio to fit a given size.

- `fill` : resizes the image without keeping the aspect ratio.

Example:

<Tabs
  scrollable
  size="small"
  type="underlined"
  defaultActiveId="js"
  queryGroup="language"
>
<TabPanel id="js" label="JavaScript">

```ts
import { createClient } from '@supabase/supabase-js'
const supabase = createClient('your_project_url', 'your_supabase_api_key')

// ---cut---
supabase.storage.from('bucket').download('image.jpg', {
  transform: {
    width: 800,
    height: 300,
    resize: 'contain', // 'cover' | 'fill'
  },
})
```

</TabPanel>
<$Show if="sdk:dart">
<TabPanel id="dart" label="Dart">

```dart
final data = supabase.storage.from('bucket').download(
      'image.jpg',
      transform: const TransformOptions(
        width: 800,
        height: 300,
        resize: ResizeMode.contain, // 'cover' | 'fill'
      ),
    );
```

</TabPanel>
</$Show>
<$Show if="sdk:swift">
<TabPanel id="swift" label="Swift">

```swift
let data = try await supabase.storage.from("bucket")
  .download(
    path: "image.jpg",
    options: TransformOptions(
      width: 800,
      height: 300,
      resize: "contain" // "cover" | "fill"
    )
  )
```

</TabPanel>
</$Show>
<$Show if="sdk:kotlin">
<TabPanel id="kotlin" label="Kotlin">

```kotlin
val data = supabase.storage.from("bucket").downloadAuthenticated("image.jpg") {
    transform {
        size(800, 300)
        resize = ImageTransformation.Resize.CONTAIN
    }
}

//Or on JVM stream directly to a file
val file = File("image.jpg")
supabase.storage.from("bucket").downloadAuthenticatedTo("image.jpg", file) {
    transform {
        size(800, 300)
        resize = ImageTransformation.Resize.CONTAIN
    }
}
```

</TabPanel>
</$Show>
<$Show if="sdk:python">
<TabPanel id="python" label="Python">

```python
response = supabase.storage.from_('bucket').download(
  'image.jpg',
  {
    'transform': {
      'width': 800,
      'height': 300,
      'resize': 'contain', # 'cover' | 'fill'
    }
  }
)
```

</TabPanel>
</$Show>
</Tabs>

### Limits

- Width and height must be an integer value between 1-2500.
- The image size cannot exceed 25MB.
- The image resolution cannot exceed 50MP.

### Supported image formats

| Format | Extension | Source | Result |
| ------ | --------- | ------ | ------ |
| PNG    | `png`     | ☑️     | ☑️     |
| JPEG   | `jpg`     | ☑️     | ☑️     |
| WebP   | `webp`    | ☑️     | ☑️     |
| AVIF   | `avif`    | ☑️     | ☑️     |
| GIF    | `gif`     | ☑️     | ☑️     |
| ICO    | `ico`     | ☑️     | ☑️     |
| SVG    | `svg`     | ☑️     | ☑️     |
| HEIC   | `heic`    | ☑️     | ❌     |
| BMP    | `bmp`     | ☑️     | ☑️     |
| TIFF   | `tiff`    | ☑️     | ☑️     |

<$Show if="billing:all">
<$Partial path="billing/pricing/pricing_storage_image_transformations.mdx" />
</$Show>

## Self hosting

Supabase image transformations can be self-hosted like any other Supabase service. Under the hood, Supabase Storage uses [imgproxy](https://imgproxy.net/) to perform the transformations.

### How self-hosting works

- Supabase Storage serves transformed images via `/storage/v1/render/image/...`
- Storage calls **imgproxy** to perform the transformation
- In self-hosted setups, you must ensure Storage can reach imgproxy over your internal network

<Admonition type="note" title="Using Supabase’s Docker stack? imgproxy is already included">
If you are using Supabase’s self-hosting Docker stack, `imgproxy` already runs as a container (typically internal-only). Storage is configured to talk to it via `IMGPROXY_URL` (for example: `http://imgproxy:5001`).

You only need to run your own imgproxy container if you have a custom setup where Storage cannot reach the bundled `imgproxy` service.

</Admonition>

### Option 1: Local development (Supabase CLI / local Docker)

Use this option if you are running Supabase locally via the Supabase CLI or a local Docker setup.

#### 1) Enable image transformations in `supabase/config.toml`

`supabase/config.toml` is used by the Supabase CLI to configure your local stack (Auth, Storage, Studio, etc.). For more details, see `/docs/guides/local-development/managing-config`.

Enable image transformations in your local config:

```toml
[storage.image_transformation]
enabled = true
```

This flag enables the feature locally, but it does not magically install or expose imgproxy — your stack must include imgproxy and Storage must be able to reach it.

#### 2) Start your local Supabase stack

Start your local stack as usual. For example:

```bash
supabase start
```

#### 3) Confirm Storage can reach imgproxy

If imgproxy is internal-only (recommended), you may not be able to `curl localhost:<port>` without explicitly publishing a port in development. Prefer checking health from inside the Docker network.

If you are using Supabase’s Docker stack, imgproxy includes a built-in health check (`imgproxy health`).

#### 4) Verify end-to-end with a transformed image URL

Hit the `/render/image` route with a simple transformation. In local development, Storage is served via your local API URL (default: `http://localhost:54321`).

```text
http://localhost:54321/storage/v1/render/image/public/<bucket>/<path-to-image>?width=200
```

If your local ports differ, run `supabase status` and use the API URL it prints.

### Option 2: Production self-hosting (your infrastructure)

Use this option if you run Storage outside of Supabase’s default Docker stack, or if `storage-api` needs to call an external imgproxy service.

#### 1) Deploy imgproxy inside a private/internal network

Do not expose imgproxy to the public internet unless you understand the security implications and have configured URL signing (see `IMGPROXY_KEY` and `IMGPROXY_SALT` below).

Example deployment:

```yaml
imgproxy:
  image: darthsim/imgproxy:v3.8.0
  environment:
    - IMGPROXY_ENABLE_WEBP_DETECTION=true
    - IMGPROXY_JPEG_PROGRESSIVE=true
```

#### 2) Configure Storage API environment variables

Set the following environment variables for your self-hosted [`storage-api`](https://github.com/supabase/storage-api):

```shell
ENABLE_IMAGE_TRANSFORMATION=true
IMGPROXY_URL=http://<internal-imgproxy-host>:<port>
```

### Configuration reference

#### Storage API (Supabase integration)

- `ENABLE_IMAGE_TRANSFORMATION`: Enables the image transformation endpoints in Storage
- `IMGPROXY_URL`: The internal URL Storage uses to call imgproxy

#### imgproxy (recommended settings)

This is a curated list of commonly used imgproxy environment variables (not exhaustive):

- Security: `IMGPROXY_KEY`, `IMGPROXY_SALT`
- Compatibility: `IMGPROXY_ENABLE_WEBP_DETECTION`, `IMGPROXY_JPEG_PROGRESSIVE`
- CORS: `IMGPROXY_ALLOW_ORIGIN`
- Quality / formats: `IMGPROXY_AUTO_WEBP`, `IMGPROXY_AUTO_AVIF`, `IMGPROXY_QUALITY`, `IMGPROXY_FORMAT_QUALITY`
- Safety: `IMGPROXY_MAX_SRC_RESOLUTION`
- Logging: `IMGPROXY_LOG_FORMAT`
- Performance/timeouts: `IMGPROXY_TIMEOUT`, `IMGPROXY_READ_REQUEST_TIMEOUT`, `IMGPROXY_WRITE_RESPONSE_TIMEOUT`

For the full list of imgproxy options, see the imgproxy docs at `https://docs.imgproxy.net/configuration`.

### Troubleshooting

- 404: Wrong bucket/path, or using a `public` route for a private bucket
- 500: Storage cannot reach imgproxy (bad `IMGPROXY_URL` or network/DNS issue)
- Health checks fail: imgproxy container not running, or the port/bind address is incorrect
- CORS errors in browsers: configure `IMGPROXY_ALLOW_ORIGIN`
- Large images fail: check the limits (25MB file size / 50MP resolution) and any `IMGPROXY_MAX_SRC_RESOLUTION` you set

{/* Finish with a video. This also appears in the Sidebar via the "tocVideo" metadata */}

<div className="video-container">
  <iframe
    src="https://www.youtube-nocookie.com/embed/dLqSmxX3r7I"
    frameBorder="1"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowFullScreen
  ></iframe>
</div>
